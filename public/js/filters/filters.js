(function() {  'use strict';  angular    .module('showfieApp')    .filter('sinceTime', function() {      return function(date) {        var _date = new Date(date);        var year = _date.getFullYear();        var month = _date.getMonth();        var day = _date.getDay();        var hour = _date.getHours();        var minutes = _date.getMinutes();        var now = new Date();        var msseconds = -(_date.getTime() - now.getTime());        var time_step = [1000, 1000*60, 1000*60*60, 1000*60*60*24];        if (msseconds < time_step[3]) {//小于一天            if (msseconds > 0 && msseconds < time_step[1]) {                return Math.floor(msseconds/time_step[0]) + " secs ago";            }            if (msseconds > time_step[1] && msseconds < time_step[2]) {                return Math.floor(msseconds/time_step[1]) + " mins ago";            }            if (msseconds > time_step[2] && msseconds < time_step[3]) {                return Math.floor(msseconds/time_step[2]) + " hours ago";            }        }        var hour = ("0"+hour).slice(-2);        var minutes = ("0"+minutes).slice(-2);        return hour+':'+minutes;      }    })    .filter('formatCount', function() {      return function(count) {        var count = parseInt(count, 10);        if (count >= 10000) {          count = count/1000;          return count+'k';        }        return count;      }    })    .filter('overflowFormat', function() {      return function(profile) {        //calculate profile length        if (profile && profile.length > 0) {          var len = 0;          var _str = '';          for(var i = 0; i < profile.length; i++) {            var c = profile.charCodeAt(i);            _str += profile[i];            if ((c >= 0x0001 && c <= 0x007e) || (0xff60<=c && c<=0xff9f)) {              len++;            } else {              len += 2;            }            if (len > 90) {              return _str + '...';            }          }          return _str;        } else {          return profile;        }      }    })})();